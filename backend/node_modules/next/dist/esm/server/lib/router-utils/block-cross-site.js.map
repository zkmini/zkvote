{"version":3,"sources":["../../../../src/server/lib/router-utils/block-cross-site.ts"],"names":["parseUrl","warnOnce","isCsrfOriginAllowed","warnOrBlockRequest","res","origin","mode","originString","statusCode","end","isInternalDevEndpoint","req","url","isMiddlewareRequest","includes","isInternalAsset","isIgnoredRequest","err","blockCrossSite","allowedDevOrigins","hostname","allowedOrigins","push","headers","undefined","rawOrigin","parsedOrigin","originLowerCase","toLowerCase"],"mappings":"AAEA,SAASA,QAAQ,QAAQ,mBAAkB;AAC3C,SAASC,QAAQ,QAAQ,4BAA2B;AACpD,SAASC,mBAAmB,QAAQ,mCAAkC;AAEtE,SAASC,mBACPC,GAA4B,EAC5BC,MAA0B,EAC1BC,IAAsB;IAEtB,MAAMC,eAAeF,SAAS,CAAC,KAAK,EAAEA,OAAO,CAAC,GAAG;IACjD,IAAIC,SAAS,QAAQ;QACnBL,SACE,CAAC,8BAA8B,EAAEM,aAAa,kPAAkP,CAAC;QAGnS,OAAO;IACT;IAEAN,SACE,CAAC,6BAA6B,EAAEM,aAAa,gLAAgL,CAAC;IAGhO,IAAI,gBAAgBH,KAAK;QACvBA,IAAII,UAAU,GAAG;IACnB;IAEAJ,IAAIK,GAAG,CAAC;IAER,OAAO;AACT;AAEA,SAASC,sBAAsBC,GAAoB;IACjD,IAAI,CAACA,IAAIC,GAAG,EAAE,OAAO;IAErB,IAAI;QACF,0DAA0D;QAC1D,MAAMC,sBAAsBF,IAAIC,GAAG,CAACE,QAAQ,CAAC;QAC7C,MAAMC,kBAAkBJ,IAAIC,GAAG,CAACE,QAAQ,CAAC;QACzC,qFAAqF;QACrF,eAAe;QACf,MAAME,mBACJL,IAAIC,GAAG,CAACE,QAAQ,CAAC,mBACjBH,IAAIC,GAAG,CAACE,QAAQ,CAAC;QAEnB,OAAO,CAACE,oBAAqBD,CAAAA,mBAAmBF,mBAAkB;IACpE,EAAE,OAAOI,KAAK;QACZ,OAAO;IACT;AACF;AAEA,OAAO,MAAMC,iBAAiB,CAC5BP,KACAP,KACAe,mBACAC;IAEA,0FAA0F;IAC1F,0DAA0D;IAC1D,MAAMd,OAAO,OAAOa,sBAAsB,cAAc,SAAS;IAEjE,MAAME,iBAAiB;QACrB;QACA;WACIF,qBAAqB,EAAE;KAC5B;IACD,IAAIC,UAAU;QACZC,eAAeC,IAAI,CAACF;IACtB;IAEA,wCAAwC;IACxC,IAAI,CAACV,sBAAsBC,MAAM;QAC/B,OAAO;IACT;IACA,4DAA4D;IAC5D,iBAAiB;IACjB,IACEA,IAAIY,OAAO,CAAC,iBAAiB,KAAK,aAClCZ,IAAIY,OAAO,CAAC,iBAAiB,KAAK,cAClC;QACA,OAAOpB,mBAAmBC,KAAKoB,WAAWlB;IAC5C;IAEA,gDAAgD;IAChD,MAAMmB,YAAYd,IAAIY,OAAO,CAAC,SAAS;IAEvC,IAAIE,WAAW;QACb,MAAMC,eAAe1B,SAASyB;QAE9B,IAAIC,cAAc;YAChB,MAAMC,kBAAkBD,aAAaN,QAAQ,CAACQ,WAAW;YAEzD,IAAI,CAAC1B,oBAAoByB,iBAAiBN,iBAAiB;gBACzD,OAAOlB,mBAAmBC,KAAKuB,iBAAiBrB;YAClD;QACF;IACF;IAEA,OAAO;AACT,EAAC"}